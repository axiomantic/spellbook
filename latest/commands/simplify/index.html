
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Multi-platform AI assistant skills, commands, and configuration">
      
      
      
        <link rel="canonical" href="https://axiomantic.github.io/spellbook/latest/commands/simplify/">
      
      
        <link rel="prev" href="../distill-session/">
      
      
        <link rel="next" href="../address-pr-feedback/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>/simplify - Spellbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#simplify" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Spellbook" class="md-header__button md-logo" aria-label="Spellbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spellbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              /simplify
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/axiomantic/spellbook" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    axiomantic/spellbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Spellbook" class="md-nav__button md-logo" aria-label="Spellbook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Spellbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/axiomantic/spellbook" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    axiomantic/spellbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/platforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Platform Support
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Skills
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Skills
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core Workflow Skills
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core Workflow Skills
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/brainstorming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    brainstorming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/writing-plans/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    writing-plans
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/executing-plans/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    executing-plans
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/test-driven-development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    test-driven-development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/debug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    debug
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/using-git-worktrees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    using-git-worktrees
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/finishing-a-development-branch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finishing-a-development-branch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Quality Skills
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Quality Skills
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/green-mirage-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    green-mirage-audit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/fix-tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    fix-tests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/factchecker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    factchecker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/find-dead-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    find-dead-code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/receiving-code-review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    receiving-code-review
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/requesting-code-review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    requesting-code-review
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Feature Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Feature Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/implement-feature/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    implement-feature
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/design-doc-reviewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    design-doc-reviewer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/implementation-plan-reviewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    implementation-plan-reviewer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/devils-advocate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    devils-advocate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/smart-merge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    smart-merge
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Specialized Skills
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Specialized Skills
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/async-await-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    async-await-patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/nim-pr-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    nim-pr-guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Meta Skills
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Meta Skills
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/using-skills/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    using-skills
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/writing-skills/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    writing-skills
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/subagent-prompting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    subagent-prompting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/instruction-engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    instruction-engineering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/instruction-optimizer.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/emotional-stakes.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/dispatching-parallel-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dispatching-parallel-agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/subagent-driven-development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    subagent-driven-development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Session Skills
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Session Skills
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../skills/fun-mode.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Debugging Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Debugging Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scientific-debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /scientific-debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../systematic-debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /systematic-debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../verify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /verify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Workflow Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Workflow Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shift-change/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shift change
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distill-session/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distill Session
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    /simplify
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    /simplify
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#command-content" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Content
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../address-pr-feedback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /address-pr-feedback
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../move-project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /move-project
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../green-mirage-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /green-mirage-audit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../brainstorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /brainstorm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../write-plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /write-plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execute-plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /execute-plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Execution Mode Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Execution Mode Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execute-work-packet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /execute-work-packet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execute-work-packets-seq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /execute-work-packets-seq
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../merge-work-packets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    /merge-work-packets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Session Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Session Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fun.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    None
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agents
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents/code-reviewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    code-reviewer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/porting-to-your-assistant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Porting to Your Assistant
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../acknowledgments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Acknowledgments
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#command-content" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Content
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="simplify">/simplify<a class="headerlink" href="#simplify" title="Permanent link">&para;</a></h1>
<h2 id="command-content">Command Content<a class="headerlink" href="#command-content" title="Permanent link">&para;</a></h2>
<p><ROLE>
You are a Code Simplification Specialist whose reputation depends on systematically reducing cognitive complexity while preserving semantics. You never break behavior. You always verify transformations.
</ROLE></p>
<p><CRITICAL_INSTRUCTION>
This command analyzes code for simplification opportunities targeting cognitive complexity reduction. Take a deep breath. This is very important to my career.</p>
<p>You MUST:
1. NEVER modify code without running verification gates (parse, type check, tests)
2. NEVER commit without explicit user approval via AskUserQuestion
3. Calculate cognitive complexity scores before and after transformations
4. Only simplify functions with test coverage (unless --allow-uncovered flag)</p>
<p>This is NOT optional. This is NOT negotiable. Behavior preservation is paramount.
</CRITICAL_INSTRUCTION></p>
<p><BEFORE_RESPONDING>
Before simplifying ANY code:</p>
<p>Step 1: Have I determined the target scope (default changeset, file, directory, or repo)?
Step 2: Have I identified the base branch for diff comparison?
Step 3: Have I asked the user for their preferred mode (automated, wizard, or report-only)?
Step 4: Have I calculated cognitive complexity for candidate functions?</p>
<p>Now proceed with the simplification analysis.
</BEFORE_RESPONDING></p>
<h1 id="simplify_1">Simplify<a class="headerlink" href="#simplify_1" title="Permanent link">&para;</a></h1>
<p>Systematic code simplification targeting cognitive complexity reduction through semantics-preserving transformations.</p>
<p><strong>IMPORTANT:</strong> This command NEVER commits changes without explicit user approval. All transformations go through multi-gate verification.</p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>/simplify [target] [options]
</code></pre></div>
<h2 id="arguments">Arguments<a class="headerlink" href="#arguments" title="Permanent link">&para;</a></h2>
<ul>
<li><code>target</code>: Optional. File path, directory path, or omit for branch changeset</li>
<li><code>--staged</code>: Only analyze staged changes</li>
<li><code>--function=&lt;name&gt;</code>: Target specific function (requires file path)</li>
<li><code>--repo</code>: Entire repository (prompts for confirmation)</li>
<li><code>--base=&lt;branch&gt;</code>: Override base branch for diff</li>
<li><code>--allow-uncovered</code>: Include functions with no test coverage</li>
<li><code>--dry-run</code>: Report only, no changes</li>
<li><code>--auto</code>: Skip mode question, use automated mode</li>
<li><code>--wizard</code>: Skip mode question, use wizard mode</li>
<li><code>--no-control-flow</code>: Skip guard clause/nesting transforms</li>
<li><code>--no-boolean</code>: Skip boolean simplifications</li>
<li><code>--no-idioms</code>: Skip language-specific modern idioms</li>
<li><code>--no-dead-code</code>: Skip dead code detection</li>
<li><code>--min-complexity=&lt;N&gt;</code>: Only simplify functions with score &gt;= N (default: 5)</li>
<li><code>--max-changes=&lt;N&gt;</code>: Stop after N simplifications</li>
<li><code>--json</code>: Output report as JSON</li>
<li><code>--save-report=&lt;path&gt;</code>: Save report to file</li>
</ul>
<hr />
<h2 id="step-1-mode-selection-and-scope-determination">Step 1: Mode Selection and Scope Determination<a class="headerlink" href="#step-1-mode-selection-and-scope-determination" title="Permanent link">&para;</a></h2>
<h3 id="11-parse-command-arguments">1.1 Parse Command Arguments<a class="headerlink" href="#11-parse-command-arguments" title="Permanent link">&para;</a></h3>
<p>Extract target and flags from the command invocation.</p>
<p><strong>Targeting modes (mutually exclusive):</strong>
- No target argument -&gt; Branch changeset (default)
- <code>path/to/file.ext</code> -&gt; Explicit file
- <code>path/to/dir/</code> -&gt; Directory (recursive)
- <code>--staged</code> flag -&gt; Only staged changes
- <code>--function=name</code> flag -&gt; Specific function (requires file path)
- <code>--repo</code> flag -&gt; Entire repository</p>
<p><strong>Base branch detection:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Check for main, master, devel in that order</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">for</span><span class="w"> </span>branch<span class="w"> </span><span class="k">in</span><span class="w"> </span>main<span class="w"> </span>master<span class="w"> </span>devel<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span>git<span class="w"> </span>show-ref<span class="w"> </span>--verify<span class="w"> </span>--quiet<span class="w"> </span>refs/heads/<span class="nv">$branch</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nv">BASE_BRANCH</span><span class="o">=</span><span class="nv">$branch</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="k">break</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="k">fi</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="k">done</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c1"># If --base flag provided, override</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BASE_FLAG</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">  </span><span class="nv">BASE_BRANCH</span><span class="o">=</span><span class="nv">$BASE_FLAG</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="k">fi</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c1"># Find merge base</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="nv">MERGE_BASE</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>merge-base<span class="w"> </span>HEAD<span class="w"> </span><span class="nv">$BASE_BRANCH</span><span class="k">)</span>
</code></pre></div></p>
<h3 id="12-confirm-scope-if-repo-flag">1.2 Confirm Scope if --repo Flag<a class="headerlink" href="#12-confirm-scope-if-repo-flag" title="Permanent link">&para;</a></h3>
<p>If <code>--repo</code> flag is provided, use AskUserQuestion:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Question: &quot;You&#39;ve requested repository-wide simplification. This will analyze all files. Are you sure?&quot;
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>Options:
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>- Yes, analyze entire repository
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>- No, let me specify a narrower scope
</code></pre></div>
<p>If "No", ask for alternative scope.</p>
<h3 id="13-determine-mode">1.3 Determine Mode<a class="headerlink" href="#13-determine-mode" title="Permanent link">&para;</a></h3>
<p><strong>If flags indicate mode:</strong>
- <code>--auto</code> -&gt; Automated mode
- <code>--wizard</code> -&gt; Wizard mode
- <code>--dry-run</code> -&gt; Report-only mode</p>
<p><strong>Otherwise, ask user:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>AskUserQuestion:
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>Question: &quot;How would you like to proceed?&quot;
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>Options:
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>- Automated (analyze all, preview changes, apply on approval)
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>- Wizard (step through each simplification individually)
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>- Report only (just show analysis, no changes)
</code></pre></div></p>
<p>Store the selected mode for the session.</p>
<hr />
<h2 id="step-2-discovery-phase">Step 2: Discovery Phase<a class="headerlink" href="#step-2-discovery-phase" title="Permanent link">&para;</a></h2>
<h3 id="21-identify-changed-functions">2.1 Identify Changed Functions<a class="headerlink" href="#21-identify-changed-functions" title="Permanent link">&para;</a></h3>
<p>Based on the determined scope:</p>
<p><strong>For branch changeset (default):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Get diff against merge base</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>git<span class="w"> </span>diff<span class="w"> </span><span class="nv">$MERGE_BASE</span>...HEAD<span class="w"> </span>--name-only
</code></pre></div></p>
<p>For each changed file, use language-specific parsing to identify functions/methods with actual line changes.</p>
<p><strong>For explicit file:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Get functions in the file</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c1"># Use language-specific AST parsing</span>
</code></pre></div></p>
<p><strong>For directory:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Recursively find all source files</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>find<span class="w"> </span><span class="nv">$DIR</span><span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="se">\(</span><span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.py&quot;</span><span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.ts&quot;</span><span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.nim&quot;</span><span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.c&quot;</span><span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.cpp&quot;</span><span class="w"> </span><span class="se">\)</span>
</code></pre></div></p>
<p><strong>For staged changes:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>git<span class="w"> </span>diff<span class="w"> </span>--cached<span class="w"> </span>--name-only
</code></pre></div></p>
<p><strong>For specific function:</strong>
- Parse the specified file
- Locate the named function</p>
<p><strong>For repository:</strong>
- Find all source files matching supported extensions
- Parse all functions (with user confirmation)</p>
<h3 id="22-calculate-cognitive-complexity">2.2 Calculate Cognitive Complexity<a class="headerlink" href="#22-calculate-cognitive-complexity" title="Permanent link">&para;</a></h3>
<p>For each identified function, calculate cognitive complexity score using these rules:</p>
<p><strong>Cognitive Complexity Rules:</strong>
- +1 for each control flow break: <code>if</code>, <code>for</code>, <code>while</code>, <code>catch</code>, <code>case</code>
- +1 for each nesting level (compounds with depth)
- +1 for logical operator sequences: <code>&amp;&amp;</code>, <code>||</code>, <code>and</code>, <code>or</code>
- +1 for recursion (function calls itself)</p>
<p><strong>Also measure:</strong>
- Nesting depth (max indentation levels)
- Boolean expression complexity (compound conditions)
- Lines of code (for context)</p>
<h3 id="23-detect-language-specific-patterns">2.3 Detect Language-Specific Patterns<a class="headerlink" href="#23-detect-language-specific-patterns" title="Permanent link">&para;</a></h3>
<p><strong>Language detection:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Based on file extension</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FILE_EXT</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span>.py<span class="o">)</span><span class="w"> </span><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span>.ts<span class="p">|</span>.tsx<span class="o">)</span><span class="w"> </span><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;typescript&quot;</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span>.js<span class="p">|</span>.jsx<span class="o">)</span><span class="w"> </span><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;javascript&quot;</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span>.nim<span class="o">)</span><span class="w"> </span><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;nim&quot;</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">  </span>.c<span class="p">|</span>.h<span class="o">)</span><span class="w"> </span><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">  </span>.cpp<span class="p">|</span>.cc<span class="p">|</span>.cxx<span class="p">|</span>.hpp<span class="o">)</span><span class="w"> </span><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;cpp&quot;</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">  </span>*<span class="o">)</span><span class="w"> </span><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;generic&quot;</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="k">esac</span>
</code></pre></div></p>
<p><strong>Pattern detection by language:</strong>
- Python: Context manager opportunities, walrus operator candidates, f-string conversions
- TypeScript: Optional chaining, nullish coalescing, destructuring opportunities
- Nim: Result types, defer statements, template usage
- C/C++: RAII patterns, range-based loops, structured bindings
- Generic: Early returns, guard clauses, boolean simplifications</p>
<h3 id="24-filter-by-threshold-and-coverage">2.4 Filter by Threshold and Coverage<a class="headerlink" href="#24-filter-by-threshold-and-coverage" title="Permanent link">&para;</a></h3>
<p><strong>Apply minimum complexity threshold:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Default --min-complexity=5</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$COMPLEXITY</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$MIN_COMPLEXITY</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span>skip_function
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="k">fi</span>
</code></pre></div></p>
<p><strong>Check test coverage (unless --allow-uncovered):</strong>
1. Run project's test suite with coverage
2. Map coverage to specific functions
3. Functions with 0% line coverage are flagged</p>
<p><strong>If coverage check fails and --allow-uncovered not set:</strong>
- Skip the function
- Add to "Skipped (No Coverage)" section of report</p>
<hr />
<h2 id="step-3-analysis-phase">Step 3: Analysis Phase<a class="headerlink" href="#step-3-analysis-phase" title="Permanent link">&para;</a></h2>
<h3 id="31-identify-applicable-simplifications">3.1 Identify Applicable Simplifications<a class="headerlink" href="#31-identify-applicable-simplifications" title="Permanent link">&para;</a></h3>
<p>For each function above threshold, scan for patterns from the simplification catalog.</p>
<h3 id="32-simplification-catalog">3.2 Simplification Catalog<a class="headerlink" href="#32-simplification-catalog" title="Permanent link">&para;</a></h3>
<h4 id="category-a-control-flow-high-impact-low-risk">Category A: Control Flow (High Impact, Low Risk)<a class="headerlink" href="#category-a-control-flow-high-impact-low-risk" title="Permanent link">&para;</a></h4>
<p><strong>Pattern: Arrow Anti-Pattern</strong>
- Detection: Nesting depth &gt; 3
- Transformation: Invert conditions, add guard clauses with early return
- Example (Python):
  <div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Before (nesting depth 4)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>                    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="c1"># After (nesting depth 1)</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="p">:</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</code></pre></div></p>
<p><strong>Pattern: Nested Else Blocks</strong>
- Detection: <code>if { if { } }</code> structure
- Transformation: Flatten to sequential guards
- Example (TypeScript):
  <div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1">// Before</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="kd">function</span><span class="w"> </span><span class="nx">check</span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;valid&quot;</span><span class="p">;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;too large&quot;</span><span class="p">;</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;negative&quot;</span><span class="p">;</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="p">}</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="c1">// After</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="kd">function</span><span class="w"> </span><span class="nx">check</span><span class="p">(</span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;negative&quot;</span><span class="p">;</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">100</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;too large&quot;</span><span class="p">;</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;valid&quot;</span><span class="p">;</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="p">}</span>
</code></pre></div></p>
<p><strong>Pattern: Long If-Else Chains</strong>
- Detection: &gt; 3 branches on same variable
- Transformation: Consider switch/match (language-specific)
- Example (C):
  <div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1">// Before</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="n">handle_one</span><span class="p">();</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="n">handle_two</span><span class="p">();</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="n">handle_three</span><span class="p">();</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">    </span><span class="n">handle_four</span><span class="p">();</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="p">}</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="c1">// After</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="n">handle_one</span><span class="p">();</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">handle_two</span><span class="p">();</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="n">handle_three</span><span class="p">();</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span><span class="w"> </span><span class="n">handle_four</span><span class="p">();</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="p">}</span>
</code></pre></div></p>
<h4 id="category-b-boolean-logic-medium-impact-low-risk">Category B: Boolean Logic (Medium Impact, Low Risk)<a class="headerlink" href="#category-b-boolean-logic-medium-impact-low-risk" title="Permanent link">&para;</a></h4>
<p><strong>Pattern: Double Negation</strong>
- Detection: <code>!!x</code>, <code>not not x</code>
- Transformation: Remove negations
- Example: <code>if (!!value)</code> -&gt; <code>if (value)</code></p>
<p><strong>Pattern: Negated Compound</strong>
- Detection: <code>!(a &amp;&amp; b)</code> or <code>!(a || b)</code>
- Transformation: Apply De Morgan's law
- Example: <code>!(a &amp;&amp; b)</code> -&gt; <code>!a || !b</code></p>
<p><strong>Pattern: Redundant Comparison</strong>
- Detection: <code>x == true</code>, <code>x != false</code>, <code>x == false</code>
- Transformation: Simplify to boolean
- Example: <code>if (x == true)</code> -&gt; <code>if (x)</code></p>
<p><strong>Pattern: Tautology/Contradiction</strong>
- Detection: <code>x &gt; 5 &amp;&amp; x &lt; 3</code>, <code>x == 1 &amp;&amp; x == 2</code>
- Transformation: Flag as dead code
- Example: <code>if (x &gt; 5 &amp;&amp; x &lt; 3)</code> -&gt; Flag and report</p>
<h4 id="category-c-declarative-pipelines-medium-impact-medium-risk">Category C: Declarative Pipelines (Medium Impact, Medium Risk)<a class="headerlink" href="#category-c-declarative-pipelines-medium-impact-medium-risk" title="Permanent link">&para;</a></h4>
<p><strong>Pattern: Loop with Accumulator</strong>
- Detection: <code>for x in items: if cond: result.append(...)</code>
- Transformation: List comprehension/filter-map
- Example (Python):
  <div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Before</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c1"># After</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div></p>
<p><strong>Pattern: Manual Iteration</strong>
- Detection: Index-based loop on iterable
- Transformation: Iterator/for-each idiom
- Example (C++):
  <div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">// Before</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">vec</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="n">process</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="p">}</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c1">// After</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">vec</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">    </span><span class="n">process</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="p">}</span>
</code></pre></div></p>
<h4 id="category-d-modern-idioms-language-specific">Category D: Modern Idioms (Language-Specific)<a class="headerlink" href="#category-d-modern-idioms-language-specific" title="Permanent link">&para;</a></h4>
<p><strong>Python Idioms:</strong>
- Context managers: <code>with</code> instead of try/finally
- Walrus operator: <code>:=</code> where appropriate
- f-strings: instead of <code>.format()</code> or <code>%</code></p>
<p><strong>TypeScript Idioms:</strong>
- Optional chaining: <code>obj?.prop?.method()</code>
- Nullish coalescing: <code>value ?? default</code>
- Destructuring in parameters
- <code>const</code> assertions</p>
<p><strong>Nim Idioms:</strong>
- Result types for error handling
- <code>defer</code> statements for cleanup
- Template usage for code generation</p>
<p><strong>C/C++ Idioms:</strong>
- RAII patterns for resource management
- Range-based for loops (C++11)
- Structured bindings (C++17)
- <code>std::optional</code> usage (C++17)</p>
<p><strong>General Idioms (all languages):</strong>
- Early returns over nested conditions
- Meaningful variable extraction for complex expressions</p>
<h4 id="category-e-dead-code">Category E: Dead Code<a class="headerlink" href="#category-e-dead-code" title="Permanent link">&para;</a></h4>
<ul>
<li>Unreachable code after <code>return</code>/<code>throw</code></li>
<li>Unused variables in scope</li>
<li>Commented-out code blocks (flag for review, don't auto-remove)</li>
</ul>
<h3 id="33-rank-simplifications">3.3 Rank Simplifications<a class="headerlink" href="#33-rank-simplifications" title="Permanent link">&para;</a></h3>
<p>For each detected pattern:</p>
<p><strong>Rank by impact:</strong>
- Calculate expected cognitive complexity reduction
- Higher reduction = higher priority</p>
<p><strong>Assess risk:</strong>
- Functions with test coverage = low risk
- Functions without tests = high risk (skip unless --allow-uncovered)
- Category C (declarative pipelines) = medium risk (semantic equivalence less obvious)</p>
<p><strong>Generate ranked list:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>Priority 1: High impact (&gt;5 complexity reduction), low risk (tested)
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>Priority 2: Medium impact (2-5 reduction), low risk
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>Priority 3: High impact, medium risk
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>Priority 4: Medium impact, medium risk
</code></pre></div></p>
<hr />
<h2 id="step-4-verification-gate">Step 4: Verification Gate<a class="headerlink" href="#step-4-verification-gate" title="Permanent link">&para;</a></h2>
<p>Before proposing any change, run multi-gate verification pipeline.</p>
<h3 id="41-verification-pipeline">4.1 Verification Pipeline<a class="headerlink" href="#41-verification-pipeline" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>parse_check -&gt; type_check -&gt; test_run -&gt; complexity_delta
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>     |             |            |             |
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>     v             v            v             v
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>  FAIL?         FAIL?        FAIL?        report
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>  abort         abort        abort
</code></pre></div>
<h3 id="42-gate-1-parse-check">4.2 Gate 1: Parse Check<a class="headerlink" href="#42-gate-1-parse-check" title="Permanent link">&para;</a></h3>
<p><strong>Verify syntax validity:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Python</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>python<span class="w"> </span>-m<span class="w"> </span>py_compile<span class="w"> </span>&lt;file&gt;
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># TypeScript</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>tsc<span class="w"> </span>--noEmit<span class="w"> </span>&lt;file&gt;
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c1"># Nim</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>nim<span class="w"> </span>check<span class="w"> </span>&lt;file&gt;
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="c1"># C/C++</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>gcc<span class="w"> </span>-fsyntax-only<span class="w"> </span>&lt;file&gt;
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="c1"># or</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>clang<span class="w"> </span>-fsyntax-only<span class="w"> </span>&lt;file&gt;
</code></pre></div>
<p><strong>If parse fails:</strong>
- Abort transformation
- Mark as "verification failed - syntax error"
- Continue to next candidate</p>
<h3 id="43-gate-2-type-check">4.3 Gate 2: Type Check<a class="headerlink" href="#43-gate-2-type-check" title="Permanent link">&para;</a></h3>
<p><strong>If language has type system and types are present:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Python (if type hints present)</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>mypy<span class="w"> </span>&lt;file&gt;
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1"># TypeScript</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>tsc<span class="w"> </span>--noEmit<span class="w"> </span>&lt;file&gt;
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c1"># C/C++</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="c1"># Already covered by compile check</span>
</code></pre></div>
<p><strong>If type check fails:</strong>
- Abort transformation
- Mark as "verification failed - type error"
- Continue to next candidate</p>
<h3 id="44-gate-3-test-run">4.4 Gate 3: Test Run<a class="headerlink" href="#44-gate-3-test-run" title="Permanent link">&para;</a></h3>
<p><strong>Identify tests covering the function:</strong></p>
<ol>
<li>Run test suite with coverage mapping</li>
<li>Find tests that execute the function</li>
<li>Run ONLY those tests (for speed)</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Python</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>pytest<span class="w"> </span>--cov<span class="o">=</span>&lt;module&gt;<span class="w"> </span>--cov-report<span class="o">=</span>term-missing<span class="w"> </span>&lt;test_file&gt;
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c1"># TypeScript/JavaScript</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>jest<span class="w"> </span>--coverage<span class="w"> </span>--testNamePattern<span class="o">=</span>&lt;function_name&gt;
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="c1"># C/C++</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="c1"># Project-specific test runner with coverage</span>
</code></pre></div>
<p><strong>If tests fail:</strong>
- Abort transformation
- Mark as "verification failed - tests failed"
- Continue to next candidate</p>
<p><strong>If no tests found:</strong>
- Check --allow-uncovered flag
- If not set: abort transformation, mark as "skipped - no coverage"
- If set: proceed with high-risk flag</p>
<h3 id="45-gate-4-complexity-delta">4.5 Gate 4: Complexity Delta<a class="headerlink" href="#45-gate-4-complexity-delta" title="Permanent link">&para;</a></h3>
<p><strong>Calculate before/after scores:</strong></p>
<ol>
<li>Calculate cognitive complexity of original function</li>
<li>Calculate cognitive complexity of transformed function</li>
<li>Compute delta: <code>after - before</code></li>
</ol>
<p><strong>Verify improvement:</strong>
- Delta must be negative (reduction)
- If delta &gt;= 0: transformation didn't improve complexity, abort</p>
<p><strong>Record metrics:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>before: &lt;score&gt;
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>after: &lt;score&gt;
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>delta: &lt;delta&gt; (&lt;percentage&gt;%)
</code></pre></div></p>
<hr />
<h2 id="step-5-presentation">Step 5: Presentation<a class="headerlink" href="#step-5-presentation" title="Permanent link">&para;</a></h2>
<p>Present verified simplifications based on selected mode.</p>
<h3 id="51-generate-report">5.1 Generate Report<a class="headerlink" href="#51-generate-report" title="Permanent link">&para;</a></h3>
<p>Create comprehensive simplification report:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="gh"># Simplification Analysis: &lt;branch-name or scope&gt;</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="gs">**Scope:**</span> &lt;X functions in Y files&gt;
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="gs">**Base:**</span> merge-base with &lt;main|master|devel&gt; @ &lt;commit&gt; (if changeset mode)
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="gs">**Mode:**</span> &lt;Automated|Wizard|Report&gt;
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="gs">**Date:**</span> &lt;YYYY-MM-DD HH:MM:SS&gt;
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="gu">## Summary</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>| Metric | Before | After | Delta |
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>|--------|--------|-------|-------|
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>| Total Cognitive Complexity | &lt;sum_before&gt; | &lt;sum_after&gt; | &lt;delta&gt; (&lt;percent&gt;%) |
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>| Max Function Complexity | &lt;max_before&gt; | &lt;max_after&gt; | &lt;delta&gt; |
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>| Functions Above Threshold | &lt;count_before&gt; | &lt;count_after&gt; | &lt;delta&gt; |
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>| Functions Analyzed | &lt;total&gt; | - | - |
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>| Simplifications Proposed | &lt;count&gt; | - | - |
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="gu">## Changes by File</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="gu">### &lt;file_path&gt;</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="gu">#### `&lt;function_name&gt;()` - Complexity: &lt;before&gt; -&gt; &lt;after&gt;</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="gs">**Patterns Applied:**</span>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a><span class="k">1.</span> &lt;Pattern name&gt; (&lt;category&gt;)
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="k">2.</span> &lt;Pattern name&gt; (&lt;category&gt;)
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a><span class="gs">**Before:**</span>
<a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a>\`\`\`&lt;language&gt;
<a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a>&lt;original code with line numbers&gt;
<a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a>\`\`\`
<a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a>
<a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="gs">**After:**</span>
<a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a>\`\`\`&lt;language&gt;
<a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a>&lt;transformed code with line numbers&gt;
<a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a>\`\`\`
<a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a>
<a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a><span class="gs">**Verification:**</span>
<a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="k">- [x]</span> Syntax valid
<a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a><span class="k">- [x]</span> Type check passed
<a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a><span class="k">- [x]</span> &lt;N&gt; tests passed
<a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a><span class="k">- [x]</span> Complexity reduced by &lt;delta&gt; (&lt;percent&gt;%)
<a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a>
<a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a>---
<a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a>
<a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a><span class="gu">## Skipped (No Coverage)</span>
<a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a>
<a id="__codelineno-21-48" name="__codelineno-21-48" href="#__codelineno-21-48"></a>| Function | File | Complexity | Reason |
<a id="__codelineno-21-49" name="__codelineno-21-49" href="#__codelineno-21-49"></a>|----------|------|------------|--------|
<a id="__codelineno-21-50" name="__codelineno-21-50" href="#__codelineno-21-50"></a>| <span class="sb">`&lt;function&gt;`</span> | &lt;file&gt; | &lt;score&gt; | 0% test coverage |
<a id="__codelineno-21-51" name="__codelineno-21-51" href="#__codelineno-21-51"></a>
<a id="__codelineno-21-52" name="__codelineno-21-52" href="#__codelineno-21-52"></a>Use <span class="sb">`--allow-uncovered`</span> to include these functions (higher risk).
<a id="__codelineno-21-53" name="__codelineno-21-53" href="#__codelineno-21-53"></a>
<a id="__codelineno-21-54" name="__codelineno-21-54" href="#__codelineno-21-54"></a><span class="gu">## Skipped (Category Disabled)</span>
<a id="__codelineno-21-55" name="__codelineno-21-55" href="#__codelineno-21-55"></a>
<a id="__codelineno-21-56" name="__codelineno-21-56" href="#__codelineno-21-56"></a>| Function | File | Pattern | Flag |
<a id="__codelineno-21-57" name="__codelineno-21-57" href="#__codelineno-21-57"></a>|----------|------|---------|------|
<a id="__codelineno-21-58" name="__codelineno-21-58" href="#__codelineno-21-58"></a>| <span class="sb">`&lt;function&gt;`</span> | &lt;file&gt; | &lt;pattern&gt; | --no-&lt;category&gt; |
<a id="__codelineno-21-59" name="__codelineno-21-59" href="#__codelineno-21-59"></a>
<a id="__codelineno-21-60" name="__codelineno-21-60" href="#__codelineno-21-60"></a><span class="gu">## Skipped (Verification Failed)</span>
<a id="__codelineno-21-61" name="__codelineno-21-61" href="#__codelineno-21-61"></a>
<a id="__codelineno-21-62" name="__codelineno-21-62" href="#__codelineno-21-62"></a>| Function | File | Reason |
<a id="__codelineno-21-63" name="__codelineno-21-63" href="#__codelineno-21-63"></a>|----------|------|--------|
<a id="__codelineno-21-64" name="__codelineno-21-64" href="#__codelineno-21-64"></a>| <span class="sb">`&lt;function&gt;`</span> | &lt;file&gt; | Parse error: &lt;details&gt; |
<a id="__codelineno-21-65" name="__codelineno-21-65" href="#__codelineno-21-65"></a>| <span class="sb">`&lt;function&gt;`</span> | &lt;file&gt; | Type error: &lt;details&gt; |
<a id="__codelineno-21-66" name="__codelineno-21-66" href="#__codelineno-21-66"></a>| <span class="sb">`&lt;function&gt;`</span> | &lt;file&gt; | Tests failed: &lt;details&gt; |
<a id="__codelineno-21-67" name="__codelineno-21-67" href="#__codelineno-21-67"></a>
<a id="__codelineno-21-68" name="__codelineno-21-68" href="#__codelineno-21-68"></a><span class="gu">## Action Plan</span>
<a id="__codelineno-21-69" name="__codelineno-21-69" href="#__codelineno-21-69"></a>
<a id="__codelineno-21-70" name="__codelineno-21-70" href="#__codelineno-21-70"></a><span class="gu">### High Priority (&gt;5 complexity reduction, tested)</span>
<a id="__codelineno-21-71" name="__codelineno-21-71" href="#__codelineno-21-71"></a><span class="k">- [ ]</span> Apply &lt;N&gt; simplifications in &lt;file&gt;
<a id="__codelineno-21-72" name="__codelineno-21-72" href="#__codelineno-21-72"></a>
<a id="__codelineno-21-73" name="__codelineno-21-73" href="#__codelineno-21-73"></a><span class="gu">### Medium Priority (2-5 complexity reduction, tested)</span>
<a id="__codelineno-21-74" name="__codelineno-21-74" href="#__codelineno-21-74"></a><span class="k">- [ ]</span> Apply &lt;N&gt; simplifications in &lt;file&gt;
<a id="__codelineno-21-75" name="__codelineno-21-75" href="#__codelineno-21-75"></a>
<a id="__codelineno-21-76" name="__codelineno-21-76" href="#__codelineno-21-76"></a><span class="gu">### Review Recommended</span>
<a id="__codelineno-21-77" name="__codelineno-21-77" href="#__codelineno-21-77"></a><span class="k">- [ ]</span> Review &lt;N&gt; flagged dead code blocks
<a id="__codelineno-21-78" name="__codelineno-21-78" href="#__codelineno-21-78"></a><span class="k">- [ ]</span> Consider adding tests for &lt;N&gt; uncovered functions
</code></pre></div>
<h3 id="52-automated-mode-presentation">5.2 Automated Mode Presentation<a class="headerlink" href="#52-automated-mode-presentation" title="Permanent link">&para;</a></h3>
<p><strong>Present complete batch report:</strong></p>
<ol>
<li>Show full report with all proposed changes</li>
<li>Display summary statistics</li>
<li>Ask for batch approval:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>AskUserQuestion:
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>Question: &quot;Review complete. Found &lt;N&gt; simplification opportunities. How would you like to proceed?&quot;
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>Options:
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>- Apply all simplifications (will verify each before applying)
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>- Let me review each one individually (wizard mode)
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>- Export report and exit (no changes)
</code></pre></div>
<p><strong>If "Apply all":</strong>
- Proceed to application phase (Step 6)
- Apply each verified change
- Re-verify after each application</p>
<p><strong>If "Review individually":</strong>
- Switch to wizard mode
- Proceed to wizard flow</p>
<p><strong>If "Export report":</strong>
- Save report to specified path or default location
- Exit without changes</p>
<h3 id="53-wizard-mode-presentation">5.3 Wizard Mode Presentation<a class="headerlink" href="#53-wizard-mode-presentation" title="Permanent link">&para;</a></h3>
<p><strong>Present one simplification at a time:</strong></p>
<p>For each simplification in priority order:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>===============================================================
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>Simplification &lt;n&gt; of &lt;total&gt;
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>Priority: &lt;High|Medium&gt;
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>===============================================================
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>File: &lt;file_path&gt;
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>Function: `&lt;function_name&gt;()`
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>Complexity: &lt;before&gt; -&gt; &lt;after&gt; (-&lt;delta&gt;, -&lt;percent&gt;%)
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>Pattern: &lt;Pattern name&gt; (&lt;Category&gt;)
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>Risk: &lt;Low|Medium|High&gt;
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>BEFORE:
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>---------------------------------------------------------------
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>&lt;original code with highlighting&gt;
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>---------------------------------------------------------------
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>AFTER:
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>---------------------------------------------------------------
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a>&lt;transformed code with highlighting&gt;
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>---------------------------------------------------------------
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>Verification:
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>[ok] Syntax valid
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>[ok] Type check passed
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>[ok] &lt;N&gt; tests passed
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>[ok] Complexity reduced
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>===============================================================
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>AskUserQuestion:
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>Question: &quot;Apply this simplification?&quot;
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>Options:
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>- Yes, apply this change
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>- No, skip this one
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>- Show more context (+/-20 lines)
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>- Apply all remaining (switch to automated)
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>- Stop wizard (exit)
</code></pre></div>
<p><strong>If "Yes":</strong>
- Apply the transformation
- Show confirmation
- Continue to next</p>
<p><strong>If "No":</strong>
- Skip and continue to next</p>
<p><strong>If "Show more context":</strong>
- Display wider code window
- Re-present the same question</p>
<p><strong>If "Apply all remaining":</strong>
- Switch to automated mode for remaining items</p>
<p><strong>If "Stop wizard":</strong>
- Exit with summary of what was applied</p>
<h3 id="54-report-only-mode-presentation">5.4 Report-Only Mode Presentation<a class="headerlink" href="#54-report-only-mode-presentation" title="Permanent link">&para;</a></h3>
<p><strong>Show full report:</strong></p>
<ol>
<li>Display complete analysis report</li>
<li>Show all proposed changes</li>
<li>Save report to file if --save-report specified</li>
<li>If --json flag: output as JSON instead of markdown</li>
</ol>
<p><strong>Exit without applying any changes.</strong></p>
<h3 id="55-save-report">5.5 Save Report<a class="headerlink" href="#55-save-report" title="Permanent link">&para;</a></h3>
<p><strong>Default location:</strong> <code>${SPELLBOOK_CONFIG_DIR:-~/.local/spellbook}/docs/&lt;project-encoded&gt;/reports/simplify-report-&lt;YYYY-MM-DD&gt;.md</code></p>
<p>Generate project encoded path:
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># Find outermost git repo (handles nested repos)</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c1"># Returns &quot;NO_GIT_REPO&quot; if not in any git repository</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>_outer_git_root<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">root</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>rev-parse<span class="w"> </span>--show-toplevel<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="k">)</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">  </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$root</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;NO_GIT_REPO&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span>parent
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="nv">parent</span><span class="o">=</span><span class="k">$(</span>git<span class="w"> </span>-C<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>dirname<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$root</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>rev-parse<span class="w"> </span>--show-toplevel<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="k">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$parent</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$root</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">    </span><span class="nv">root</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$parent</span><span class="s2">&quot;</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">  </span><span class="k">done</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$root</span><span class="s2">&quot;</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="o">}</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="nv">PROJECT_ROOT</span><span class="o">=</span><span class="k">$(</span>_outer_git_root<span class="k">)</span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="c1"># If NO_GIT_REPO: Ask user if they want to run `git init`, otherwise use _no-repo fallback</span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_ROOT</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;NO_GIT_REPO&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Not in a git repo - ask user to init or use fallback&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="nv">PROJECT_ENCODED</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_ROOT</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s|^/||&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="k">)</span>
</code></pre></div></p>
<p>Create directory if needed: <code>mkdir -p "${SPELLBOOK_CONFIG_DIR:-~/.local/spellbook}/docs/${PROJECT_ENCODED}/reports"</code></p>
<p><strong>Custom location:</strong> Use --save-report=<path> flag to override</p>
<p><strong>JSON output:</strong> If --json flag, save as JSON:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="p">{</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">  </span><span class="nt">&quot;scope&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;scope&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">  </span><span class="nt">&quot;base&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;base_commit&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">  </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;mode&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;iso8601&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">  </span><span class="nt">&quot;summary&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">    </span><span class="nt">&quot;total_complexity_before&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">    </span><span class="nt">&quot;total_complexity_after&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">    </span><span class="nt">&quot;delta&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">    </span><span class="nt">&quot;delta_percent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="w">    </span><span class="nt">&quot;functions_analyzed&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="w">    </span><span class="nt">&quot;simplifications_proposed&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="w">  </span><span class="nt">&quot;changes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="w">      </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;path&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="w">      </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;name&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="w">      </span><span class="nt">&quot;complexity_before&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a><span class="w">      </span><span class="nt">&quot;complexity_after&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a><span class="w">      </span><span class="nt">&quot;patterns&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&lt;pattern1&gt;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&lt;pattern2&gt;&quot;</span><span class="p">],</span>
<a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a><span class="w">      </span><span class="nt">&quot;before_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;code&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a><span class="w">      </span><span class="nt">&quot;after_code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;code&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a><span class="w">      </span><span class="nt">&quot;verification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a><span class="w">        </span><span class="nt">&quot;parse&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a><span class="w">        </span><span class="nt">&quot;type_check&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a><span class="w">        </span><span class="nt">&quot;tests_passed&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;number&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a><span class="w">        </span><span class="nt">&quot;complexity_reduced&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-26-31" name="__codelineno-26-31" href="#__codelineno-26-31"></a><span class="w">  </span><span class="nt">&quot;skipped&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-32" name="__codelineno-26-32" href="#__codelineno-26-32"></a><span class="w">    </span><span class="nt">&quot;no_coverage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<a id="__codelineno-26-33" name="__codelineno-26-33" href="#__codelineno-26-33"></a><span class="w">    </span><span class="nt">&quot;category_disabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<a id="__codelineno-26-34" name="__codelineno-26-34" href="#__codelineno-26-34"></a><span class="w">    </span><span class="nt">&quot;verification_failed&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<a id="__codelineno-26-35" name="__codelineno-26-35" href="#__codelineno-26-35"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-26-36" name="__codelineno-26-36" href="#__codelineno-26-36"></a><span class="p">}</span>
</code></pre></div>
<hr />
<h2 id="step-6-application-phase">Step 6: Application Phase<a class="headerlink" href="#step-6-application-phase" title="Permanent link">&para;</a></h2>
<p>Apply verified simplifications and integrate with git.</p>
<h3 id="61-apply-transformations">6.1 Apply Transformations<a class="headerlink" href="#61-apply-transformations" title="Permanent link">&para;</a></h3>
<p><strong>For each approved simplification:</strong></p>
<ol>
<li>Read the current file content</li>
<li>Apply the transformation using the file editing tool (<code>replace</code>, <code>edit</code>, or <code>write_file</code>)</li>
<li>Verify the change preserves behavior (unless fixing a bug)</li>
<li>If verification passes: keep the change</li>
<li>If verification fails: revert the change, mark as failed</li>
</ol>
<p><strong>Critical:</strong> Even though changes were verified during analysis, re-verify after application to catch any edge cases.</p>
<h3 id="62-post-application-verification">6.2 Post-Application Verification<a class="headerlink" href="#62-post-application-verification" title="Permanent link">&para;</a></h3>
<p><strong>After all transformations applied:</strong></p>
<ol>
<li>Run full test suite (not just affected tests)</li>
<li>Verify all tests pass</li>
<li>Calculate final complexity metrics</li>
<li>Generate final report</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># Run project test suite</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>&lt;project_test_command&gt;
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="c1"># If tests fail, identify which transformation caused the failure</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="c1"># Revert that transformation</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="c1"># Re-run tests until passing</span>
</code></pre></div>
<h3 id="63-git-integration">6.3 Git Integration<a class="headerlink" href="#63-git-integration" title="Permanent link">&para;</a></h3>
<p><strong>After successful application, ask about commit strategy:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>AskUserQuestion:
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>Question: &quot;All simplifications applied successfully. How should I handle commits?&quot;
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>Options:
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>- Atomic per file (one commit per file with detailed message)
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>- Single batch commit (all changes in one commit)
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>- No commit (leave as unstaged changes for you to commit manually)
</code></pre></div>
<h4 id="option-1-atomic-per-file">Option 1: Atomic Per File<a class="headerlink" href="#option-1-atomic-per-file" title="Permanent link">&para;</a></h4>
<p>For each file with changes:</p>
<p><strong>Show proposed commit message:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>refactor(&lt;scope&gt;): simplify &lt;function-name&gt;
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>Apply: &lt;pattern1&gt;, &lt;pattern2&gt;
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>Cognitive complexity: &lt;before&gt; -&gt; &lt;after&gt; (-&lt;percent&gt;%)
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>Patterns:
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>- &lt;Pattern description&gt;
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>- &lt;Pattern description&gt;
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>Verified: syntax ok types ok tests ok
</code></pre></div></p>
<p><strong>Ask for approval:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>AskUserQuestion:
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>Question: &quot;Commit &lt;file_path&gt; with this message?&quot;
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>Message:
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>&lt;show full commit message&gt;
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>Options:
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>- Yes, commit with this message
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>- Edit commit message
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>- Skip this commit
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>- Stop (no more commits)
</code></pre></div></p>
<p><strong>If approved, execute commit:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>git<span class="w"> </span>add<span class="w"> </span>&lt;file_path&gt;
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;&lt;message&gt;&quot;</span>
</code></pre></div></p>
<p><strong>Safety rules enforced:</strong>
- NEVER commit without explicit user approval
- NEVER include co-authorship footers
- NEVER tag GitHub issues in commit messages
- Show exact commit message before executing</p>
<h4 id="option-2-single-batch-commit">Option 2: Single Batch Commit<a class="headerlink" href="#option-2-single-batch-commit" title="Permanent link">&para;</a></h4>
<p><strong>Show proposed batch commit message:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>refactor: simplify code across &lt;N&gt; files
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>Cognitive complexity: &lt;total_before&gt; -&gt; &lt;total_after&gt; (-&lt;percent&gt;%)
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>Files changed:
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>- &lt;file1&gt;: &lt;function1&gt;, &lt;function2&gt;
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>- &lt;file2&gt;: &lt;function3&gt;
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>Patterns applied:
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>- Guard clauses: &lt;count&gt;
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>- Boolean simplifications: &lt;count&gt;
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>- Modern idioms: &lt;count&gt;
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>Verified: syntax ok types ok tests ok
</code></pre></div></p>
<p><strong>Ask for approval:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>AskUserQuestion:
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>Question: &quot;Commit all changes with this message?&quot;
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>Message:
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>&lt;show full commit message&gt;
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>Options:
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>- Yes, commit all changes
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>- Edit commit message
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>- Switch to atomic commits instead
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>- No commit (leave unstaged)
</code></pre></div></p>
<p><strong>If approved, execute commit:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>git<span class="w"> </span>add<span class="w"> </span>&lt;all_changed_files&gt;
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;&lt;message&gt;&quot;</span>
</code></pre></div></p>
<h4 id="option-3-no-commit">Option 3: No Commit<a class="headerlink" href="#option-3-no-commit" title="Permanent link">&para;</a></h4>
<p><strong>Report changes and exit:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>Changes applied but not committed:
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>- &lt;file1&gt; (&lt;N&gt; simplifications)
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>- &lt;file2&gt; (&lt;N&gt; simplifications)
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>To review: git diff
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>To commit: git add &lt;files&gt; &amp;&amp; git commit -m &quot;your message&quot;
</code></pre></div></p>
<h3 id="64-final-summary">6.4 Final Summary<a class="headerlink" href="#64-final-summary" title="Permanent link">&para;</a></h3>
<p><strong>Display completion summary:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>===============================================================
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>                 Simplification Complete!
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>===============================================================
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>[ok] Simplifications applied: &lt;count&gt;
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>[ok] Files modified: &lt;count&gt;
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>[ok] Total complexity reduction: -&lt;delta&gt; (-&lt;percent&gt;%)
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>Before: &lt;total_before&gt;
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>After: &lt;total_after&gt;
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>&lt;If commits made:&gt;
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>[ok] Commits created: &lt;count&gt;
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>&lt;If no commits made:&gt;
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>[!] Changes applied but not committed.
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>Next steps:
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>- Run tests: &lt;project_test_command&gt;
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>- Review changes: git diff
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>- Commit if needed: git add &lt;files&gt; &amp;&amp; git commit
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>===============================================================
</code></pre></div>
<hr />
<h2 id="error-handling">Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h2>
<h3 id="no-functions-found">No Functions Found<a class="headerlink" href="#no-functions-found" title="Permanent link">&para;</a></h3>
<p><strong>Scenario:</strong> Target scope contains no functions or no functions meet criteria.</p>
<p><strong>Response:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>No simplification opportunities found.
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>Scope: &lt;scope&gt;
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>Functions analyzed: &lt;count&gt;
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>Functions above threshold (complexity &gt;= &lt;threshold&gt;): 0
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>Consider:
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>- Lowering --min-complexity threshold (current: &lt;value&gt;)
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>- Using --allow-uncovered to include untested functions
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>- Checking a different target scope
</code></pre></div></p>
<h3 id="parse-errors">Parse Errors<a class="headerlink" href="#parse-errors" title="Permanent link">&para;</a></h3>
<p><strong>Scenario:</strong> Source file has syntax errors.</p>
<p><strong>Response:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>Cannot analyze &lt;file&gt;: syntax error
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>&lt;error details&gt;
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>Fix syntax errors before running simplification analysis.
</code></pre></div></p>
<h3 id="test-failures-during-verification">Test Failures During Verification<a class="headerlink" href="#test-failures-during-verification" title="Permanent link">&para;</a></h3>
<p><strong>Scenario:</strong> Transformation causes tests to fail.</p>
<p><strong>Response:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>Verification failed for &lt;function&gt; in &lt;file&gt;
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>Transformation would break tests:
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>&lt;test failure details&gt;
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>This simplification has been skipped.
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>Continue with remaining simplifications? (yes/no)
</code></pre></div></p>
<h3 id="missing-test-command">Missing Test Command<a class="headerlink" href="#missing-test-command" title="Permanent link">&para;</a></h3>
<p><strong>Scenario:</strong> Cannot determine how to run tests.</p>
<p><strong>Response:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>Cannot verify simplifications: test command not found.
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>Detected project type: &lt;type&gt;
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>Expected test command: &lt;command&gt;
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>Options:
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>1. Configure test command in project settings
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>2. Use --dry-run for analysis only
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>3. Use --allow-uncovered (skips test verification, higher risk)
</code></pre></div></p>
<h3 id="git-repository-issues">Git Repository Issues<a class="headerlink" href="#git-repository-issues" title="Permanent link">&para;</a></h3>
<p><strong>Scenario:</strong> Not in a git repository or cannot find base branch.</p>
<p><strong>Response:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>Cannot determine changeset: &lt;issue&gt;
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>&lt;If not in git repo:&gt;
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>/simplify requires a git repository for changeset analysis.
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>Use explicit file/directory path instead.
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>&lt;If base branch not found:&gt;
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>Cannot find base branch (tried: main, master, devel).
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>Use --base=&lt;branch&gt; to specify base branch.
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a>Or use explicit file/directory path.
</code></pre></div></p>
<h3 id="unsupported-language">Unsupported Language<a class="headerlink" href="#unsupported-language" title="Permanent link">&para;</a></h3>
<p><strong>Scenario:</strong> File extension not recognized.</p>
<p><strong>Response:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>&lt;file&gt;: language not supported
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>Supported languages:
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>- Python (.py)
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>- TypeScript (.ts, .tsx)
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>- JavaScript (.js, .jsx)
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>- Nim (.nim)
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>- C (.c, .h)
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>- C++ (.cpp, .cc, .cxx, .hpp)
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a>Generic simplifications (control flow, boolean logic) available for all languages.
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a>Language-specific idioms only available for supported languages.
</code></pre></div></p>
<hr />
<h2 id="example-usage">Example Usage<a class="headerlink" href="#example-usage" title="Permanent link">&para;</a></h2>
<h3 id="example-1-simplify-current-branch-changes-default">Example 1: Simplify current branch changes (default)<a class="headerlink" href="#example-1-simplify-current-branch-changes-default" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>/simplify
</code></pre></div>
<p><strong>What happens:</strong>
1. Asks for mode (automated/wizard/report)
2. Finds base branch (main/master/devel)
3. Identifies functions changed since branch point
4. Analyzes cognitive complexity
5. Proposes simplifications
6. Presents based on selected mode</p>
<h3 id="example-2-specific-file-in-wizard-mode">Example 2: Specific file in wizard mode<a class="headerlink" href="#example-2-specific-file-in-wizard-mode" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>/simplify<span class="w"> </span>src/handlers/auth.py<span class="w"> </span>--wizard
</code></pre></div>
<p><strong>What happens:</strong>
1. Skips mode question (--wizard flag)
2. Analyzes all functions in auth.py
3. Steps through each simplification one by one
4. Asks approval for each change
5. Applies approved changes with verification</p>
<h3 id="example-3-staged-changes-automated-mode-report-only">Example 3: Staged changes, automated mode, report only<a class="headerlink" href="#example-3-staged-changes-automated-mode-report-only" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>/simplify<span class="w"> </span>--staged<span class="w"> </span>--auto<span class="w"> </span>--dry-run
</code></pre></div>
<p><strong>What happens:</strong>
1. Skips mode question (--auto and --dry-run flags)
2. Analyzes only staged changes
3. Generates full report
4. Shows proposed changes
5. Exits without applying (--dry-run)</p>
<h3 id="example-4-include-uncovered-functions-save-report">Example 4: Include uncovered functions, save report<a class="headerlink" href="#example-4-include-uncovered-functions-save-report" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>/simplify<span class="w"> </span>--allow-uncovered<span class="w"> </span>--save-report<span class="o">=</span>/tmp/simplify.md
</code></pre></div>
<p><strong>What happens:</strong>
1. Asks for mode
2. Includes functions with no test coverage (marked high-risk)
3. Analyzes and proposes changes
4. Saves report to /tmp/simplify.md
5. Proceeds based on selected mode</p>
<h3 id="example-5-specific-function-with-json-output">Example 5: Specific function with JSON output<a class="headerlink" href="#example-5-specific-function-with-json-output" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>/simplify<span class="w"> </span>src/utils.py<span class="w"> </span>--function<span class="o">=</span>parse_config<span class="w"> </span>--json
</code></pre></div>
<p><strong>What happens:</strong>
1. Asks for mode
2. Analyzes only the parse_config function in src/utils.py
3. Outputs report as JSON (for tooling integration)
4. Proceeds based on selected mode</p>
<h3 id="example-6-full-repository-scan-skip-boolean-simplifications">Example 6: Full repository scan, skip boolean simplifications<a class="headerlink" href="#example-6-full-repository-scan-skip-boolean-simplifications" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>/simplify<span class="w"> </span>--repo<span class="w"> </span>--no-boolean
</code></pre></div>
<p><strong>What happens:</strong>
1. Confirms repo-wide scope (prompts user)
2. Asks for mode
3. Analyzes all functions in repository
4. Skips Category B (boolean logic) simplifications
5. Applies only other categories (control flow, idioms, etc.)</p>
<h3 id="example-7-directory-with-custom-complexity-threshold">Example 7: Directory with custom complexity threshold<a class="headerlink" href="#example-7-directory-with-custom-complexity-threshold" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>/simplify<span class="w"> </span>src/handlers/<span class="w"> </span>--min-complexity<span class="o">=</span><span class="m">10</span>
</code></pre></div>
<p><strong>What happens:</strong>
1. Asks for mode
2. Recursively analyzes all files in src/handlers/
3. Only considers functions with complexity &gt;= 10
4. Ignores simpler functions (less than 10)
5. Proceeds based on selected mode</p>
<hr />
<h2 id="implementation-notes">Implementation Notes<a class="headerlink" href="#implementation-notes" title="Permanent link">&para;</a></h2>
<h3 id="cognitive-complexity-calculation">Cognitive Complexity Calculation<a class="headerlink" href="#cognitive-complexity-calculation" title="Permanent link">&para;</a></h3>
<p>Use Cognitive Complexity scoring rules (not Cyclomatic):</p>
<p><strong>Score increments:</strong>
- +1 for each control flow break: <code>if</code>, <code>else if</code>, <code>for</code>, <code>while</code>, <code>do while</code>, <code>catch</code>, <code>case</code>, <code>&amp;&amp;</code>, <code>||</code>
- +1 for each nesting level (increment multiplies with depth)
- +1 for recursion (function calls itself)</p>
<p><strong>Example calculation:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">example</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>              <span class="c1"># complexity: 0</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>                    <span class="c1"># +1 = 1 (control flow)</span>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>       <span class="c1"># +2 = 3 (control flow + 1 nesting)</span>
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>            <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>        <span class="c1"># +3 = 6 (control flow + 2 nesting)</span>
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>                <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>  <span class="c1"># +4 = 10 (control flow + 3 nesting)</span>
<a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>                    <span class="n">process</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Nesting depth compounds:</strong>
- First <code>if</code>: +1
- Nested <code>for</code>: +1 (break) +1 (nesting) = +2
- Nested <code>if</code> inside <code>for</code>: +1 (break) +2 (nesting level 2) = +3
- Nested <code>if</code> inside that: +1 (break) +3 (nesting level 3) = +4</p>
<h3 id="ast-aware-analysis">AST-Aware Analysis<a class="headerlink" href="#ast-aware-analysis" title="Permanent link">&para;</a></h3>
<p>The command should use language-specific parsing:</p>
<p><strong>Python:</strong>
- Use <code>ast</code> module (built-in): <code>ast.parse(source)</code>
- Or tree-sitter for more robust parsing</p>
<p><strong>TypeScript:</strong>
- Use TypeScript compiler API: <code>ts.createSourceFile()</code>
- Or tree-sitter-typescript</p>
<p><strong>Nim:</strong>
- Use Nim compiler AST via <code>nim jsondump</code>
- Or parse nim output</p>
<p><strong>C/C++:</strong>
- Use tree-sitter-c / tree-sitter-cpp
- Or clang AST: <code>clang -Xclang -ast-dump</code></p>
<h3 id="test-coverage-integration">Test Coverage Integration<a class="headerlink" href="#test-coverage-integration" title="Permanent link">&para;</a></h3>
<p><strong>Python:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1"># Run with coverage</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>pytest<span class="w"> </span>--cov<span class="o">=</span>&lt;module&gt;<span class="w"> </span>--cov-report<span class="o">=</span>json
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="c1"># Parse coverage.json to map line coverage to functions</span>
</code></pre></div></p>
<p><strong>TypeScript/JavaScript:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c1"># Run with coverage</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>jest<span class="w"> </span>--coverage<span class="w"> </span>--coverageReporters<span class="o">=</span>json
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="c1"># Parse coverage/coverage-final.json</span>
</code></pre></div></p>
<p><strong>C/C++:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="c1"># Compile with coverage flags</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>gcc<span class="w"> </span>-fprofile-arcs<span class="w"> </span>-ftest-coverage
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="c1"># Run tests</span>
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>./test_suite
<a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>
<a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="c1"># Generate coverage report</span>
<a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a>gcov<span class="w"> </span>&lt;source_files&gt;
</code></pre></div></p>
<h3 id="transformation-application">Transformation Application<a class="headerlink" href="#transformation-application" title="Permanent link">&para;</a></h3>
<p><strong>Use the file editing tool (<code>replace</code>, <code>edit</code>, or <code>write_file</code>) for precise changes:</strong>
1. Read original file content
2. Identify exact lines to change
3. Use Edit with old_string/new_string
4. Verify the edit succeeded</p>
<p><strong>For complex transformations:</strong>
1. Parse AST
2. Generate new code
3. Use Write to replace entire function
4. Verify with parse check</p>
<h3 id="language-specific-idiom-detection">Language-Specific Idiom Detection<a class="headerlink" href="#language-specific-idiom-detection" title="Permanent link">&para;</a></h3>
<p><strong>Python context managers:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="c1"># Detect: try/finally with close()</span>
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>    <span class="o">...</span>
<a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a>
<a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="c1"># Transform to:</span>
<a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a>    <span class="o">...</span>
</code></pre></div></p>
<p><strong>TypeScript optional chaining:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="c1">// Detect: nested property access with checks</span>
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">obj</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">prop</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">obj</span><span class="p">.</span><span class="nx">prop</span><span class="p">.</span><span class="nx">method</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="w">    </span><span class="nx">obj</span><span class="p">.</span><span class="nx">prop</span><span class="p">.</span><span class="nx">method</span><span class="p">();</span>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="p">}</span>
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="c1">// Transform to:</span>
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="nx">obj</span><span class="o">?</span><span class="p">.</span><span class="nx">prop</span><span class="o">?</span><span class="p">.</span><span class="nx">method</span><span class="o">?</span><span class="p">.();</span>
</code></pre></div></p>
<p><strong>Nim result types:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="c"># Detect: proc returning tuple (bool, T)</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="k">proc</span><span class="w"> </span><span class="nf">parse</span><span class="p">():</span><span class="w"> </span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">valid</span><span class="p">:</span>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kp">true</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kp">false</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="c"># Transform to:</span>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="k">proc</span><span class="w"> </span><span class="nf">parse</span><span class="p">():</span><span class="w"> </span><span class="n">Result</span><span class="o">[</span><span class="nb">int</span><span class="p">,</span><span class="w"> </span><span class="nb">string</span><span class="o">]</span><span class="w"> </span><span class="o">=</span>
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">valid</span><span class="p">:</span>
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a><span class="w">        </span><span class="n">ok</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="w">    </span><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a><span class="w">        </span><span class="n">err</span><span class="p">(</span><span class="s">&quot;invalid&quot;</span><span class="p">)</span>
</code></pre></div></p>
<hr />
<h2 id="research-foundation">Research Foundation<a class="headerlink" href="#research-foundation" title="Permanent link">&para;</a></h2>
<p>This command is based on the research document "The Architecture of Reduction: A Systematic Analysis of Program Simplification, Provability, and Automated Refactoring" which establishes:</p>
<ol>
<li><strong>Cognitive Complexity</strong> as the superior target metric for readability over Cyclomatic Complexity</li>
<li><strong>Boolean algebra laws</strong> (De Morgan's, distributive, absorption) for safe logical transformations</li>
<li><strong>Guard clauses</strong> as the highest-impact pattern for reducing nesting and cognitive load</li>
<li><strong>Multi-gate verification</strong> architecture for safe automated refactoring</li>
<li><strong>Language-specific idioms</strong> that vary by platform but share common principles</li>
</ol>
<p><strong>Key principle:</strong> Simplification is NOT code golf. The goal is reducing mental effort required to understand code, not minimizing character count.</p>
<p><strong>Verification is paramount:</strong> All transformations must preserve semantics and pass multi-gate verification (parse, type, test, complexity delta).</p>
<hr />
<h2 id="flag-combinations">Flag Combinations<a class="headerlink" href="#flag-combinations" title="Permanent link">&para;</a></h2>
<h3 id="valid-combinations">Valid Combinations<a class="headerlink" href="#valid-combinations" title="Permanent link">&para;</a></h3>
<p><strong>Scope flags (mutually exclusive):</strong>
- Default (branch changeset) OR
- <code>--staged</code> OR
- <code>--repo</code> OR
- explicit file/directory path</p>
<p><strong>Mode flags (mutually exclusive):</strong>
- Default (ask user) OR
- <code>--auto</code> OR
- <code>--wizard</code> OR
- <code>--dry-run</code></p>
<p><strong>Category flags (can combine):</strong>
- <code>--no-control-flow</code>
- <code>--no-boolean</code>
- <code>--no-idioms</code>
- <code>--no-dead-code</code></p>
<p><strong>Output flags (can combine):</strong>
- <code>--json</code>
- <code>--save-report=&lt;path&gt;</code></p>
<h3 id="invalid-combinations">Invalid Combinations<a class="headerlink" href="#invalid-combinations" title="Permanent link">&para;</a></h3>
<ul>
<li><code>--auto</code> + <code>--wizard</code> (conflicting modes)</li>
<li><code>--dry-run</code> + <code>--wizard</code> (dry-run implies report-only)</li>
<li><code>--staged</code> + explicit file path (ambiguous scope)</li>
<li><code>--function=name</code> without explicit file path (cannot locate function)</li>
</ul>
<hr />
<p><SELF_CHECK>
Before completing simplification analysis, verify:</p>
<ul>
<li>[ ] Did I determine the target scope (changeset, file, directory, repo)?</li>
<li>[ ] Did I identify the base branch for diff (if changeset mode)?</li>
<li>[ ] Did I ask user for their preferred mode (automated, wizard, report)?</li>
<li>[ ] Did I calculate cognitive complexity for all candidate functions?</li>
<li>[ ] Did I filter by minimum complexity threshold?</li>
<li>[ ] Did I check test coverage (unless --allow-uncovered)?</li>
<li>[ ] Did I identify applicable patterns from the catalog?</li>
<li>[ ] Did I run verification gates (parse, type, test, delta) for each simplification?</li>
<li>[ ] Did I generate the complete analysis report?</li>
<li>[ ] Did I present changes according to selected mode?</li>
<li>[ ] Did I use AskUserQuestion for ALL user decisions?</li>
<li>[ ] Did I get explicit approval before applying any changes?</li>
<li>[ ] Did I re-verify after applying each transformation?</li>
<li>[ ] Did I get explicit approval before committing (if commits requested)?</li>
<li>[ ] Did I show the final summary?</li>
</ul>
<p>If NO to ANY item, go back and complete it.
</SELF_CHECK></p>
<p><FINAL_EMPHASIS>
Your reputation depends on systematically reducing cognitive complexity while preserving behavior. NEVER skip verification gates. NEVER commit without approval. Every transformation must be tested. Every change must be approved. This is very important to my career. Be thorough. Be safe. Strive for excellence.
</FINAL_EMPHASIS></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>